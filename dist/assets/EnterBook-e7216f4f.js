import{b as A,c as H}from"./index-9a105738.js";import{g as J,m as K,u as Q,h,k as X,r as R,o,c as l,e,t as a,F as $,b as B,a as Z,j as _,n as ee,E as g,l as y,w as f,i as j,G,B as O,p as se,d as te,_ as oe}from"./index-e9f8ae92.js";const m=p=>(se("data-v-9b7c9fc7"),p=p(),te(),p),ae={class:"container"},le={class:"head"},ne=m(()=>e("span",{class:"split"},"|",-1)),ce={class:"title"},ie={class:"bookTime"},de={class:"nowTime"},ue={class:"contain-bookTime"},re=["onClick"],_e={style:{"font-size":"12px"}},ve={class:"bottom"},he={class:"pagination"},pe={class:"doctor"},ke={key:0,class:"last-time"},be=m(()=>e("div",{class:"time-title"},[_("明天 "),e("span",null,"08:30"),_(" 放号")],-1)),ge={class:"count-time"},ye={key:1,class:"detail-doctor"},fe={class:"top"},me=m(()=>e("h2",{class:"title"},"上午号源",-1)),Ce={key:0,class:"main"},we={class:"left"},Ne={class:"level"},De={class:"info"},$e={class:"right"},Be={class:"fee"},Te={class:"button"},Se={class:"bottom"},xe=m(()=>e("h2",{class:"title"},"下午号源",-1)),Ee={key:0,class:"main"},Le={class:"left"},ze={class:"level"},Fe={class:"info"},Ie={class:"right"},Me={class:"fee"},We={class:"button"},qe=J({__name:"EnterBook",setup(p){const C=K(),P=Q(),d=h(0),c=h(),w=h(),T=h(1);let N,D;const i=h(0),S=h("");X(()=>{N=C.query.hoscode,D=C.query.depcode,E(),U()});const U=()=>{setInterval(()=>{const t=new Date,r=+((new Date(`${t.getUTCFullYear()}-${t.getMonth()+1}-${t.getDate()+1} 08:30:00`).getTime()-t.getTime())/1e3).toFixed(0),v=(r/60/60).toFixed(0),k=(r/60%60).toFixed(0),b=(r%60).toFixed(0);S.value=`${v} 时 ${k} 分 ${b} 秒`},1e3)},x=t=>{t.status===-1?i.value=-1:t.status===0&&t.availableNumber>0?i.value=1:t.status===0&&t.availableNumber<=0?i.value=0:i.value=2},Y=t=>{T.value=t,E()},E=async()=>{const t=await A(T.value,7,N,D);c.value=t.data.data,d.value=0,x(c.value.bookingScheduleList[0]),L(c.value.bookingScheduleList[0],0)},L=async(t,u)=>{d.value=u;const r=await H(N,D,t.workDate);x({status:t.status,availableNumber:t.availableNumber}),w.value=r.data},z=t=>{P.push({path:"/hospital/register",query:{scheduleId:t,hoscode:C.query.hoscode}})};return(t,u)=>{var k,b,F,I,M,W,q,V;const r=R("el-pagination"),v=R("el-button");return o(),l("div",ae,[e("div",le,[e("span",null,a((k=c.value)==null?void 0:k.baseMap.hosname),1),ne,e("span",null,a((b=c.value)==null?void 0:b.baseMap.bigname),1)]),e("h2",ce,a((F=c.value)==null?void 0:F.baseMap.depname),1),e("div",ie,[e("h3",de,a((I=c.value)==null?void 0:I.baseMap.workDateString),1),e("div",ue,[(o(!0),l($,null,B((M=c.value)==null?void 0:M.bookingScheduleList,(s,n)=>(o(),l("div",{class:"bookTimeList",onClick:Ve=>L(s,n)},[e("div",{class:ee(["top",{active:d.value===n}])},[e("span",null,a(s.workDate),1),e("span",_e,a(s.dayOfWeek),1)],2),e("div",ve,[s.status===-1?(o(),l("p",{key:0,style:g({fontWeight:d.value===n?"700":""})},"停止挂号",4)):s.status===0&&s.availableNumber>0?(o(),l("p",{key:1,style:g({fontWeight:d.value===n?"700":""})},"有号",4)):s.status===0&&s.availableNumber<=0?(o(),l("p",{key:2,style:g({fontWeight:d.value===n?"700":""})},"无号",4)):(o(),l("p",{key:3,style:g({fontWeight:d.value===n?"700":""})},"即将放号",4))])],8,re))),256))]),e("div",he,[Z(r,{layout:"prev, pager, next",total:(W=c.value)==null?void 0:W.total,onCurrentChange:Y},null,8,["total"])])]),e("div",pe,[i.value===2?(o(),l("div",ke,[be,e("div",ge,[_("倒 计 时 "),e("span",null,a(S.value),1)])])):(o(),l("div",ye,[e("div",fe,[me,(o(!0),l($,null,B((q=w.value)==null?void 0:q.data,s=>(o(),l("div",{class:"top-doctor",key:s.id},[s.workTime===0?(o(),l("div",Ce,[e("div",we,[e("h2",Ne,a(s.title)+"   "+a(s.docname),1),e("h2",De,a(s.skill),1)]),e("div",$e,[e("p",Be,"￥"+a(s.amount),1),e("div",Te,[i.value===-1||i.value===0?(o(),y(v,{key:0,type:"info",size:"large",onClick:u[0]||(u[0]=n=>j(G).error("预约失败"))},{default:f(()=>[_("剩余"+a(s.availableNumber),1)]),_:2},1024)):(o(),y(v,{key:1,type:"primary",size:"large",onClick:n=>z(s.id)},{default:f(()=>[_("剩余"+a(s.availableNumber),1)]),_:2},1032,["onClick"]))])])])):O("",!0)]))),128))]),e("div",Se,[xe,(o(!0),l($,null,B((V=w.value)==null?void 0:V.data,s=>(o(),l("div",{class:"bottom-doctor",key:s.id},[s.workTime===1?(o(),l("div",Ee,[e("div",Le,[e("h2",ze,a(s.title),1),e("h2",Fe,a(s.skill),1)]),e("div",Ie,[e("p",Me,"￥"+a(s.amount),1),e("div",We,[i.value===-1||i.value===0?(o(),y(v,{key:0,type:"info",size:"large",onClick:u[1]||(u[1]=n=>j(G).error("预约失败"))},{default:f(()=>[_("剩余"+a(s.availableNumber),1)]),_:2},1024)):(o(),y(v,{key:1,type:"primary",size:"large",onClick:n=>z(s.id)},{default:f(()=>[_("剩余"+a(s.availableNumber),1)]),_:2},1032,["onClick"]))])])])):O("",!0)]))),128))])]))])])}}});const Ge=oe(qe,[["__scopeId","data-v-9b7c9fc7"]]);export{Ge as default};
